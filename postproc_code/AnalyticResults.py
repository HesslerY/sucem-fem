import numpy as N

def err_percentage(orig, calc):
    return N.abs(orig - calc)/N.abs(orig)*100

accoustic_eigs = {
    'rect1x0.75x0.5': N.array([9.869604401089358e+00,
                               1.754596337971441e+01,
                               2.741556778080377e+01,
                               3.947841760435743e+01,
                               3.947841760435743e+01,
                               4.934802200544680e+01,
                               5.702438098407183e+01,
                               5.702438098407183e+01,
                               6.689398538516120e+01,
                               7.018385351885765e+01], N.float64)}

PEC_cavity = {
    'rect1x0.75x0.5': N.array([5.23598775598,
                               7.02481473104,
                               7.55144893276,
                               7.55144893276,
                               8.17887433484,
                               8.17887433484,
                               8.88576587632,
                               8.94725979951,
                               9.82358379556,
                               9.82358379556], N.float64)**2,
    'rect-white': N.array([0.174334894134,
                           0.197674435692,
                           0.214468462824,
                           0.240275424654,
                           0.240275424654,
                           0.256123661055,
                           0.272546981207,
                           0.293877435017,
                           0.304858908565,
                           0.304858908565], N.float64)**2,
    'rect1x0.25x5.1': N.array([3.20141509749,
                               3.37452534476,
                               3.64481720106,
                               3.99260215981,
                               4.39954088907,
                               4.8507686518,
                               5.33505964753,
                               5.8442001012,
                               6.31330910297,
                               6.37223639342])**2
    }

#smaller-2 has mesh_length 0.5/3.5
#smaller-3 has mesh_length 0.5/3
#smaller-4 has mesh_length 0.5/2.5
#smaller-5 has mesh_length 0.5/2

PEC_cavity_eigs_calc = {'rect1x0.75x0.5': {'mesh0-smaller5': ({'eigs': N.array(
    [27.415567169194968, 49.348039854945483, 57.024375285835561, 57.024464950656387, 66.894021169595817, 66.894091377462217, 78.956962673020854, 80.05348558412912, 96.502668498132351, 96.503653321742519], N.float64),
                                                               'dofs':6612 ,
                                                               'nnz':763622,
                                                               'LU_nnz': 22834255,
                                                               'order': 'mixed 4',
                                                               'mesh_length': 0.5/2},
                                                              {'eigs': N.array(
    [27.415568802497006, 49.348134874197548, 57.024475879852218, 57.024574739521533, 66.894334981904663, 66.894371212124497, 78.957592428648368, 80.053702425083344, 96.504519076277901, 96.504567184085005], N.float64),
                                                               'dofs':8265 ,
                                                               'nnz': 1198105,
                                                               'LU_nnz': 36584986,
                                                               'order': '4',
                                                               'mesh_length': 0.5/2},),
                                           'mesh0-smaller4': ({'eigs': N.array(
    [27.415582011746721, 49.348041733057343, 57.024721978798233, 57.024890184102119,
     66.893280753226705, 66.894031191715413, 78.959954629179123, 80.056871574085392,
     96.505948051354935, 96.507677777919341], N.float64),
                                                               'dofs': 7332,
                                                               'nnz': 518882,
                                                               'LU_nnz': 34464085,
                                                               'order': 'mixed 3',
                                                               'mesh_length': 0.5/2.5},
                                                              {'eigs': N.array(
    [27.415690023928487, 49.348842998548349, 57.026322586887225, 57.026415767542055,
     66.896848972959262, 66.897043303226098, 78.964415649677107, 80.062903839425786,
     96.517258485307181, 96.520039653204989], N.float64),
                                                               'dofs': 9776,
                                                               'nnz': 930286,
                                                               'LU_nnz': 64903496,
                                                               'order': '3',
                                                               'mesh_length': 0.5/2.5},
                                                              {'eigs': N.array(
    [27.415567781419561, 49.348023822240428, 57.024377712517939, 57.024379012983829,
     66.893999399933904, 66.894000765237024, 78.956824960231458, 80.05343487972165,
     96.502715851143208, 96.502787306976856], N.float64),
                                                               'dofs': 16512,
                                                               'nnz': 2064722,
                                                               'LU_nnz': 156196385,
                                                               'order': 'mixed 4',
                                                               'mesh_length': 0.5/2.5},                                                              ),
                                           'mesh0-smaller3': ({'eigs': N.array(
    [27.415572681581274, 49.348121899457794, 57.024527065341658, 57.024673239606543,
     66.894175112129517, 66.894410111020505, 78.957869830623494, 80.053662570605212,
     96.503644711533795, 96.503823535066175], N.float64),
                                  'dofs': 11106,
                                  'nnz': 784176,
                                  'LU_nnz': 79120958,
                                  'order': 'mixed 3',
                                  'mesh_length': 0.5/3},),
                                            'mesh0-smaller1': ({'eigs': N.array(
    [27.416482712060574, 49.352530725120381, 57.030968697449282, 57.032437007159587,
     66.907288699813066, 66.910587275030878, 78.97740314971054, 80.075804644322716,
     96.544024117340882, 96.548292022220707], N.float64),
                                  'dofs': 9394,
                                  'nnz': 362004,
                                  'LU_nnz': 15067356,
                                  'order': 'mixed 2',
                                  'mesh_length': 0.5/4},
                                          {'eigs': N.array(
    [27.418258479774057, 49.363843995729965, 57.04803013258848, 57.048418737746445,
     66.932634838036904, 66.934721107303872, 79.020593376144973, 80.119054911616772,
     96.618366094109916, 96.620078871230234], N.float64),
                                           'dofs': 14091,
                                           'nnz': 812367,
                                           'LU_nnz': 136164842,
                                           'order': '2',
                                           'mesh_length': 0.5/4},
                                          ),
                       'mesh0': ({'eigs': N.array(
    [27.346442255386375,  49.100299170945405,  56.508474856551544, 56.835800191692492,
     65.944215785041365, 66.194792400328367, 78.003788872725238, 79.550811647295944,
     94.646308846854879, 95.30841709116271], N.float64),
                                  'dofs': 2501,
                                  'nnz': 36303,
                                  'LU_nnz': 484973,
                                  'order': 'mixed 1',
                                  'mesh_length': 0.5/4.5},
                                 {'eigs': N.array(
    [27.416156182575168, 49.350916214513489, 57.028525400799516, 57.029563419718293,
     66.902103579183759, 66.9027970481404, 78.96870173743612, 80.064140529972718,
     96.526233892107797, 96.529488133515073], N.float64),
                                  'dofs': 14438,
                                  'nnz': 566444,
                                  'LU_nnz': 47113072,
                                  'order': 'mixed 2',
                                  'mesh_length': 0.5/4.5},),
                       'mesh1': ({'eigs': N.array(
    [27.355859443509299, 49.220708382699321, 56.721953450613242, 56.801135162881302,
     66.534594004439683, 66.642220523600244, 78.63286460778987, 79.495209141692939,
     95.831106861956059, 95.996433451061264], N.float64),
                                  'dofs': 5853,
                                  'nnz': 87581,
                                  'LU_nnz': 1322303,
                                  'order': 'mixed 1',
                                  'mesh_length': 0.5/6},),
                       'mesh2': ({'eigs': N.array(
    [27.402246306211026,49.308775948266842,56.966119334068125, 56.968872930449017,
     66.815148320296359, 66.826000856520807, 78.845740734436774,
     79.930984838128282, 96.337157315304879, 96.356128781132895], N.float64),
                                  'dofs': 49366,
                                  'nnz': 778478,
                                  'LU_nnz': 41406739,
                                  'order': 'mixed 1',
                                  'mesh_length': 0.5/12},),
                    }
    }

accoustic_eigs_calc = {
    'rect1x0.75x0.5': {'mesh0': ({'eigs': N.array(
    [  9.86301757,  17.52545846,  27.36299151,  39.33311182,
       39.36542069,  49.13270748,  56.73273631,  56.79269226,
       66.60855839,  69.7626601 ]),
                                 'dofs': 4718,
                                 'nnz': 31484,
                                 'LU_nnz': 484973,
                                 'order': 'mixed 1',
                                  'mesh_length': 0.5/4.5},
                                 {'eigs': N.array(
    [9.90680629238, 17.6621130884, 27.7057969614, 40.0494947778,
     40.0581782885, 50.2575301213, 58.2337440424, 58.2629229049,
     68.6312011867, 71.9895427589]),
                                 'dofs': 14154,
                                 'nnz': 283356,
                                 'LU_nnz': 71258129,
                                 'order': '1',
                                  'mesh_length': 0.5/4.5},),
                      'mesh1': ({'eigs': N.array(
    [  9.86473352,  17.52965379,  27.37751991,  39.40025969,
       39.40943812,  49.22857591,  56.87172359,  56.89170376,
       66.69812201,  69.93969061]),
                                 'dofs': 10839,
                                 'nnz' : 73063,
                                 'LU_nnz': 1464280,
                                 'order': 'mixed 1',
                                 'mesh_length': 0.5/6},
                                 {'eigs': N.array([
    9.88997042056, 17.6098989141, 27.5722891525, 39.808881575, 39.8146398475,
    49.8621141068, 57.7125844547, 57.7282049325, 67.8528563357, 71.2079989681]),
                                 'dofs': 32517,
                                 'nnz': 657567,
                                 'LU_nnz': 'n/a',
                                 'order': '1',
                                  'mesh_length': 0.5/4.5},                                ),
                       'mesh2': ({'eigs': N.array(
    [  9.86840709,  17.54199757,  27.40616168,  39.45834046,
       39.45931519,  49.31727593,  56.98426896,  56.98537279,
       66.83811406,  70.11945738]),
                                 'dofs': 88319,
                                 'nnz' : 606851,
                                 'LU_nnz': 35163114,
                                 'order': 'mixed 1',
                                 'mesh_length': 0.5/12}),
                       'mesh3': ({'eigs': N.array(
    [9.8690521755268374, 17.544244147341544, 27.411407796418388, 39.469524284793721,
     39.469823369419402, 49.33440960364549, 57.005982226553954, 57.006408603068166,
     66.869267286349412, 70.156307807026721]),
                                 'dofs': 299412,
                                 'nnz' : 2070096,
                                 'LU_nnz': 'n/a',
                                 'order': 'mixed 1',
                                 'mesh_length': 0.5/18}),
                                }
    }
